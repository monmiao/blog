[{"title":"gulp搭建前端工作流","url":"https://monmiao.github.io/2017/03/13/gulp-work-flow/","content":"<h3 id=\"摘要\"><a href=\"#摘要\" class=\"headerlink\" title=\"摘要\"></a>摘要</h3><ul>\n<li>这个项目基于上一篇<a href=\"https://monmiao.github.io/2017/03/10/gulp-own-guide/\">“gulp搭建Es6环境项目指南”</a>的基础上进行搭建,我会在原来的基础上进行修改,它可以进行sass编译,es6转es5,压缩js,压缩css,压缩图片,压缩html(这个好像没什么效果),解决js/css缓存问题,启动本地开发Web服务器,我用的是mac,配合charles手机可以进行访问(局域网下直接访问本机ip,注意开放端口/关闭防火墙,我是关闭防火墙没有成功,所以用charles进行代理).</li>\n</ul>\n<h3 id=\"安装gulp\"><a href=\"#安装gulp\" class=\"headerlink\" title=\"安装gulp\"></a>安装gulp</h3><ul>\n<li><p>首先确认已经安装好node, 检查是否安装 node -v 如果能看到版本,表示已经安装成功.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 全局安装Gulp</div><div class=\"line\">$ npm install -g gulp</div><div class=\"line\"># 在项目中安装Gulp</div><div class=\"line\">$ npm install --save-dev gulp</div></pre></td></tr></table></figure>\n</li>\n<li><p>运行gulp -v,如果不报错，表示安装成功.</p>\n</li>\n</ul>\n<h3 id=\"新建项目目录\"><a href=\"#新建项目目录\" class=\"headerlink\" title=\"新建项目目录\"></a>新建项目目录</h3><ul>\n<li>比如gulp-pro,在命令行中进入到改项目目录,执行<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># 在项目中安装Gulp</span></div><div class=\"line\">$ npm install --save-dev gulp</div><div class=\"line\"><span class=\"comment\"># 让项目生产package.json文件</span></div><div class=\"line\">$ npm init</div></pre></td></tr></table></figure>\n</li>\n</ul>\n<h3 id=\"项目目录结构\"><a href=\"#项目目录结构\" class=\"headerlink\" title=\"项目目录结构\"></a>项目目录结构</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div></pre></td><td class=\"code\"><pre><div class=\"line\">-------------------gulp-pro</div><div class=\"line\">|   |</div><div class=\"line\">|   |--------------dist (该文件夹为打包生成的)</div><div class=\"line\">|   |   |----------css</div><div class=\"line\">|   |   |   |------index-xxxx.css</div><div class=\"line\">|   |   |----------js</div><div class=\"line\">|   |   |   |------index-xxxx.js</div><div class=\"line\">|   |   |----------html</div><div class=\"line\">|   |   |   |------home</div><div class=\"line\">|   |   |   |   |------index.html</div><div class=\"line\">|   |   |   |------index.html</div><div class=\"line\">|   |</div><div class=\"line\">|   |--------------src</div><div class=\"line\">|   |   |----------scss</div><div class=\"line\">|   |   |   |------index.scss</div><div class=\"line\">|   |   |----------js</div><div class=\"line\">|   |   |   |------index.js</div><div class=\"line\">|   |   |----------html</div><div class=\"line\">|   |   |   |------home</div><div class=\"line\">|   |   |   |   |------index.html</div><div class=\"line\">|   |   |   |------index.html</div><div class=\"line\">|   |</div><div class=\"line\">|   |--------------gulpfile.js</div><div class=\"line\">|   |--------------package.json</div></pre></td></tr></table></figure>\n<h3 id=\"安装相关插件\"><a href=\"#安装相关插件\" class=\"headerlink\" title=\"安装相关插件\"></a>安装相关插件</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># 安装 Gulp 上 Babel 的插件</span></div><div class=\"line\">$ npm install --save-dev gulp-babel </div><div class=\"line\"><span class=\"comment\"># 安装 Gulp 上 uglify 压缩插件</span></div><div class=\"line\">$ npm install --save-dev gulp-uglify </div><div class=\"line\"><span class=\"comment\"># 安装 Gulp 上 sass 插件</span></div><div class=\"line\">$ npm install --save-dev gulp-sass </div><div class=\"line\"><span class=\"comment\"># 安装 Gulp 上 clean 插件</span></div><div class=\"line\">$ npm install --save-dev gulp-clean </div><div class=\"line\"><span class=\"comment\"># 安装 Gulp 上 rev 插件</span></div><div class=\"line\">$ npm install --save-dev gulp-rev </div><div class=\"line\"><span class=\"comment\"># 安装 Gulp 上 rev-collector 插件 </span></div><div class=\"line\">$ npm install --save-dev gulp-rev-collector</div><div class=\"line\"><span class=\"comment\"># 安装 Gulp 上 run-sequence 插件 </span></div><div class=\"line\">$ npm install --save-dev run-sequence</div><div class=\"line\"><span class=\"comment\"># 安装 Gulp 上 gulp-webserver 插件 </span></div><div class=\"line\">$ npm install --save-dev gulp-webserver</div><div class=\"line\"><span class=\"comment\"># 安装 Gulp 上 gulp-autoprefixer 插件 </span></div><div class=\"line\">$ npm install --save-dev gulp-autoprefixer</div><div class=\"line\"><span class=\"comment\"># 安装 Gulp 上 gulp-imagemin 插件 </span></div><div class=\"line\">$ npm install --save-dev gulp-imagemin</div><div class=\"line\"><span class=\"comment\"># 安装 Gulp 上 imagemin-pngquant 插件 </span></div><div class=\"line\">$ npm install --save-dev imagemin-pngquant</div><div class=\"line\"><span class=\"comment\"># 安装 Gulp 上 gulp-cache 插件 </span></div><div class=\"line\">$ npm install --save-dev gulp-cache</div><div class=\"line\"><span class=\"comment\"># 安装 Gulp 上 gulp-htmlmin 插件 </span></div><div class=\"line\">$ npm install --save-dev gulp-htmlmin</div><div class=\"line\"><span class=\"comment\"># 安装 Gulp 上 gulp-minify-html 插件 </span></div><div class=\"line\">$ npm install --save-dev gulp-minify-html</div></pre></td></tr></table></figure>\n<h3 id=\"创建相关的文件\"><a href=\"#创建相关的文件\" class=\"headerlink\" title=\"创建相关的文件\"></a>创建相关的文件</h3><ul>\n<li><p>在项目目录下,创建名为’.babelrc’(Babel工具和模块的使用,都必须先写好.babelrc,),该文件用来设置转码规则和插件,内容如下:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">&#123;</div><div class=\"line\">  &quot;presets&quot;: [&quot;es2015&quot;]</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n</li>\n<li><p>创建’gulpfile.js’文件</p>\n</li>\n</ul>\n<h3 id=\"gulpfile-js-内容如下\"><a href=\"#gulpfile-js-内容如下\" class=\"headerlink\" title=\"gulpfile.js 内容如下\"></a>gulpfile.js 内容如下</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div><div class=\"line\">113</div><div class=\"line\">114</div><div class=\"line\">115</div><div class=\"line\">116</div><div class=\"line\">117</div><div class=\"line\">118</div><div class=\"line\">119</div><div class=\"line\">120</div><div class=\"line\">121</div><div class=\"line\">122</div><div class=\"line\">123</div><div class=\"line\">124</div><div class=\"line\">125</div><div class=\"line\">126</div><div class=\"line\">127</div><div class=\"line\">128</div><div class=\"line\">129</div><div class=\"line\">130</div><div class=\"line\">131</div><div class=\"line\">132</div><div class=\"line\">133</div><div class=\"line\">134</div><div class=\"line\">135</div><div class=\"line\">136</div><div class=\"line\">137</div><div class=\"line\">138</div><div class=\"line\">139</div><div class=\"line\">140</div><div class=\"line\">141</div><div class=\"line\">142</div><div class=\"line\">143</div><div class=\"line\">144</div><div class=\"line\">145</div><div class=\"line\">146</div><div class=\"line\">147</div><div class=\"line\">148</div><div class=\"line\">149</div><div class=\"line\">150</div><div class=\"line\">151</div><div class=\"line\">152</div><div class=\"line\">153</div><div class=\"line\">154</div><div class=\"line\">155</div><div class=\"line\">156</div><div class=\"line\">157</div><div class=\"line\">158</div><div class=\"line\">159</div><div class=\"line\">160</div><div class=\"line\">161</div><div class=\"line\">162</div><div class=\"line\">163</div><div class=\"line\">164</div><div class=\"line\">165</div><div class=\"line\">166</div></pre></td><td class=\"code\"><pre><div class=\"line\">var gulp = require(&quot;gulp&quot;);</div><div class=\"line\">var babel = require(&quot;gulp-babel&quot;);// 用于ES6转化ES5</div><div class=\"line\">var uglify = require(&apos;gulp-uglify&apos;);// 用于压缩 JS</div><div class=\"line\">var sass = require(&apos;gulp-sass&apos;); //scss编译</div><div class=\"line\">var rev = require(&apos;gulp-rev&apos;); //rev hash码</div><div class=\"line\">var reCollector = require(&apos;gulp-rev-collector&apos;); //替换html中的js,css文件 刷新缓存</div><div class=\"line\">var clean = require(&apos;gulp-clean&apos;);//清空文件夹里所有的文件</div><div class=\"line\">var webserver = require(&apos;gulp-webserver&apos;);//服务器</div><div class=\"line\">var autoprefixer = require(&apos;gulp-autoprefixer&apos;);//css浏览器内核前缀自动补全</div><div class=\"line\">var runSequence = require(&apos;run-sequence&apos;);//顺序执行</div><div class=\"line\">var minImage = require(&apos;gulp-imagemin&apos;);//图片压缩</div><div class=\"line\">var minImageForPng = require(&apos;imagemin-pngquant&apos;);//图片压缩（png）</div><div class=\"line\">var cache = require(&quot;gulp-cache&quot;);//缓存</div><div class=\"line\">var minHtml = require(&quot;gulp-htmlmin&quot;);//html压缩（js、css压缩）</div><div class=\"line\">var minHtmlForJT = require(&quot;gulp-minify-html&quot;);//html压缩（js模板压缩）</div><div class=\"line\">/**</div><div class=\"line\"> * 生产环境product</div><div class=\"line\"> */</div><div class=\"line\">// ES6转化为ES5</div><div class=\"line\">// 在命令行使用 gulp toes5 启动此任务</div><div class=\"line\">gulp.task(&quot;toes5&quot;, () =&gt; &#123;</div><div class=\"line\">    return gulp.src(&quot;src/es6js/*.js&quot;)// ES6 源码存放的路径</div><div class=\"line\">        .pipe(babel())</div><div class=\"line\">        .pipe(gulp.dest(&quot;src/js&quot;)); //转换成 ES5 存放的路径</div><div class=\"line\">&#125;);</div><div class=\"line\">//scss编译</div><div class=\"line\">gulp.task(&apos;pro-css&apos;, () =&gt; &#123;</div><div class=\"line\">    return gulp.src(&apos;src/sass/**/*.scss&apos;)</div><div class=\"line\">        .pipe(sass(&#123;</div><div class=\"line\">            outputStyle: &apos;compressed&apos;//编译并输出压缩过的文件</div><div class=\"line\">        &#125;))</div><div class=\"line\">        .pipe(rev())//给css添加哈希值</div><div class=\"line\">        .pipe(gulp.dest(&apos;dist/css&apos;))</div><div class=\"line\">        .pipe(rev.manifest())//给添加哈希值的文件添加到清单中</div><div class=\"line\">        .pipe(gulp.dest(&apos;rev/css&apos;));</div><div class=\"line\">&#125;);</div><div class=\"line\">//压缩js</div><div class=\"line\">gulp.task(&apos;pro-js&apos;, () =&gt; &#123;</div><div class=\"line\">    return gulp.src(&apos;src/es6js/**/*.js&apos;)</div><div class=\"line\">        .pipe(babel()) //转换成 ES5 </div><div class=\"line\">        .pipe(uglify()) //压缩js</div><div class=\"line\">        .pipe(rev()) //给js添加哈希值</div><div class=\"line\">        .pipe(gulp.dest(&apos;dist/js&apos;))</div><div class=\"line\">        .pipe(rev.manifest()) //给添加哈希值的文件添加到清单中</div><div class=\"line\">        .pipe(gulp.dest(&apos;rev/js&apos;));</div><div class=\"line\">&#125;);</div><div class=\"line\">//将处理过的css，js引入html</div><div class=\"line\">gulp.task(&apos;reCollector&apos;, () =&gt; &#123;</div><div class=\"line\">    return gulp.src([&apos;rev/**/*.json&apos;, &apos;src/html/**/*.html&apos;])</div><div class=\"line\">        .pipe(reCollector(&#123;</div><div class=\"line\">            replaceReved: true,  //模板中已经被替换的文件是否还能再被替换,默认是false</div><div class=\"line\">            dirReplacements: &#123;   //标识目录替换的集合, 因为gulp-rev创建的manifest文件不包含任何目录信息,</div><div class=\"line\">                &apos;css/&apos;: &apos;css/&apos;,</div><div class=\"line\">                &apos;js/&apos;: &apos;js/&apos;</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;))</div><div class=\"line\">        .pipe(gulp.dest(&apos;dist/html&apos;))</div><div class=\"line\">&#125;);</div><div class=\"line\">//每次打包时先清空原有的文件夹</div><div class=\"line\">gulp.task(&apos;clean&apos;, () =&gt; &#123;</div><div class=\"line\">    return gulp.src([&apos;dist&apos;, &apos;rev&apos;], &#123;read: false&#125;) //这里设置的dist表示删除dist文件夹及其下所有文件</div><div class=\"line\">        .pipe(clean());</div><div class=\"line\">&#125;);</div><div class=\"line\">gulp.task(&apos;pro-webServer&apos;, function () &#123;</div><div class=\"line\">    return gulp.src(&apos;dist/&apos;)</div><div class=\"line\">        .pipe(webserver(&#123;</div><div class=\"line\">            port: 10889,//端口</div><div class=\"line\">            livereload: true,</div><div class=\"line\">            // directoryListing: true,</div><div class=\"line\">            directoryListing: &#123;</div><div class=\"line\">                enable: true,</div><div class=\"line\">                path: &apos;./dist&apos;</div><div class=\"line\">            &#125;,</div><div class=\"line\">            open: true</div><div class=\"line\">        &#125;));</div><div class=\"line\">&#125;);</div><div class=\"line\">// 自动添加前缀</div><div class=\"line\">gulp.task(&apos;autoFx&apos;, function () &#123;</div><div class=\"line\">    gulp.src(&apos;dist/css/**/*.css&apos;)</div><div class=\"line\">        .pipe(autoprefixer(&#123;</div><div class=\"line\">            browsers: [&apos;last 2 versions&apos;],</div><div class=\"line\">            cascade: true, //是否美化属性值 默认：true 像这样：</div><div class=\"line\">            //-webkit-transform: rotate(45deg);</div><div class=\"line\">            //        transform: rotate(45deg);</div><div class=\"line\">            remove: true //是否去掉不必要的前缀 默认：true</div><div class=\"line\">        &#125;))</div><div class=\"line\">        .pipe(gulp.dest(&apos;dist/css&apos;));</div><div class=\"line\">&#125;);</div><div class=\"line\">//压缩图片</div><div class=\"line\">gulp.task(&apos;minImage&apos;, function () &#123;</div><div class=\"line\">    return gulp.src(&apos;src/images/**/*.&#123;png,jpg,gif,ico&#125;&apos;)</div><div class=\"line\">        .pipe(cache(minImage(&#123;</div><div class=\"line\">            progressive: true,</div><div class=\"line\">            use: [minImageForPng()]</div><div class=\"line\">        &#125;)))</div><div class=\"line\">        .pipe(gulp.dest(&apos;dist/images&apos;));</div><div class=\"line\">&#125;);</div><div class=\"line\">//压缩html</div><div class=\"line\">gulp.task(&apos;minHtml&apos;, function () &#123;</div><div class=\"line\">    return gulp.src(&apos;src/html/**/*.html&apos;)</div><div class=\"line\">        .pipe(minHtmlForJT())//附带压缩页面上的js模板</div><div class=\"line\">        .pipe(minHtml(&#123;</div><div class=\"line\">            removeComments: true,</div><div class=\"line\">            collapseWhitespace: true,</div><div class=\"line\">            collapseBooleanAttributes: true,</div><div class=\"line\">            removeEmptyAttributes: true,</div><div class=\"line\">            removeScriptTypeAttributes: true,</div><div class=\"line\">            removeStyleLinkTypeAttributes: true,</div><div class=\"line\">            minifyJS: true,</div><div class=\"line\">            minifyCSS: true</div><div class=\"line\">        &#125;))//附带压缩页面上的css、js</div><div class=\"line\">        .pipe(gulp.dest(&apos;src/dist&apos;));</div><div class=\"line\">&#125;);</div><div class=\"line\">gulp.task(&apos;product&apos;, function (callback) &#123;</div><div class=\"line\">    runSequence(</div><div class=\"line\">        &apos;clean&apos;,</div><div class=\"line\">        [&apos;pro-js&apos;, &apos;pro-css&apos;, &apos;minImage&apos;],</div><div class=\"line\">        &apos;autoFx&apos;,</div><div class=\"line\">        &apos;reCollector&apos;,</div><div class=\"line\">        &apos;minHtml&apos;,</div><div class=\"line\">        &apos;pro-webServer&apos;,</div><div class=\"line\">        callback);</div><div class=\"line\">&#125;);</div><div class=\"line\">/**</div><div class=\"line\"> * 测试环境test</div><div class=\"line\"> */</div><div class=\"line\">//scss编译</div><div class=\"line\">gulp.task(&apos;test-css&apos;, () =&gt; &#123;</div><div class=\"line\">    return gulp.src(&apos;src/sass/**/*.scss&apos;)</div><div class=\"line\">        .pipe(sass(&#123;</div><div class=\"line\">            outputStyle: &apos;compressed&apos;//编译并输出压缩过的文件</div><div class=\"line\">        &#125;))</div><div class=\"line\">        .pipe(gulp.dest(&apos;src/css&apos;))</div><div class=\"line\">&#125;);</div><div class=\"line\">//压缩js</div><div class=\"line\">gulp.task(&apos;test-js&apos;, () =&gt; &#123;</div><div class=\"line\">    return gulp.src(&apos;src/es6js/**/*.js&apos;)</div><div class=\"line\">        .pipe(babel()) //转换成 ES5</div><div class=\"line\">        .pipe(uglify()) //压缩js</div><div class=\"line\">        .pipe(gulp.dest(&apos;src/js&apos;))</div><div class=\"line\">&#125;);</div><div class=\"line\">//创建watch任务去检测html文件,其定义了当html改动之后，去调用一个Gulp的Task</div><div class=\"line\">gulp.task(&apos;watch&apos;, function () &#123;</div><div class=\"line\">    gulp.watch([&apos;./src/sass/**/*.scss&apos;], [&apos;test-css&apos;]);</div><div class=\"line\">    gulp.watch([&apos;./src/es6js/**/*.js&apos;], [&apos;test-js&apos;]);</div><div class=\"line\">&#125;);</div><div class=\"line\">gulp.task(&apos;test-webServer&apos;, function () &#123;</div><div class=\"line\">    return gulp.src(&apos;src/&apos;)</div><div class=\"line\">        .pipe(webserver(&#123;</div><div class=\"line\">            port: 10888,//端口</div><div class=\"line\">            livereload: true,</div><div class=\"line\">            // directoryListing: true,</div><div class=\"line\">            directoryListing: &#123;</div><div class=\"line\">                enable: true,</div><div class=\"line\">                path: &apos;./src&apos;</div><div class=\"line\">            &#125;,</div><div class=\"line\">            open: true</div><div class=\"line\">        &#125;));</div><div class=\"line\">&#125;);</div><div class=\"line\">gulp.task(&apos;test&apos;, function (callback) &#123;</div><div class=\"line\">    runSequence(</div><div class=\"line\">        [&apos;test-js&apos;, &apos;test-css&apos;],</div><div class=\"line\">        &apos;watch&apos;,</div><div class=\"line\">        &apos;test-webServer&apos;,</div><div class=\"line\">        callback);</div><div class=\"line\">&#125;);</div></pre></td></tr></table></figure>\n<h3 id=\"task执行命令\"><a href=\"#task执行命令\" class=\"headerlink\" title=\"task执行命令\"></a>task执行命令</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># gulp 任务名称</span></div><div class=\"line\">$ gulp product //生产打包</div><div class=\"line\">$ gulp <span class=\"built_in\">test</span> //测试运行</div></pre></td></tr></table></figure>\n<h3 id=\"github地址-gulp-workflow\"><a href=\"#github地址-gulp-workflow\" class=\"headerlink\" title=\"github地址: gulp-workflow\"></a>github地址: <a href=\"https://github.com/marquessc/gulp-workflow\" target=\"_blank\" rel=\"external\">gulp-workflow</a></h3><h3 id=\"说明\"><a href=\"#说明\" class=\"headerlink\" title=\"说明\"></a>说明</h3><ul>\n<li>该文档是gulp入坑的记录,如果错误欢迎留言指正,如有转载,请注明出处,谢谢.</li>\n</ul>\n","categories":["技术"],"tags":["笔记"]},{"title":"gulp搭建Es6环境项目指南","url":"https://monmiao.github.io/2017/03/10/gulp-own-guide/","content":"<ul>\n<li>这个项目最终想要得到的效果是可以预编译ES6,SCSS,压缩css,压缩js</li>\n<li>首先确认已经安装好node, 检查是否安装 node -v 如果能看到版本,表示已经安装成功.</li>\n</ul>\n<h3 id=\"安装gulp\"><a href=\"#安装gulp\" class=\"headerlink\" title=\"安装gulp\"></a>安装gulp</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 全局安装Gulp</div><div class=\"line\">$ npm install -g gulp</div><div class=\"line\"># 在项目中安装Gulp</div><div class=\"line\">$ npm install --save-dev gulp</div></pre></td></tr></table></figure>\n<ul>\n<li>运行gulp -v,如果不报错，表示安装成功.</li>\n</ul>\n<h3 id=\"新建项目目录-比如gulp-pro-在命令行中进入到改项目目录-执行\"><a href=\"#新建项目目录-比如gulp-pro-在命令行中进入到改项目目录-执行\" class=\"headerlink\" title=\"新建项目目录,比如gulp-pro,在命令行中进入到改项目目录,执行\"></a>新建项目目录,比如gulp-pro,在命令行中进入到改项目目录,执行</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># 在项目中安装Gulp</span></div><div class=\"line\">$ npm install --save-dev gulp</div><div class=\"line\"><span class=\"comment\"># 让项目生产package.json文件</span></div><div class=\"line\">$ npm init</div></pre></td></tr></table></figure>\n<h3 id=\"创建项目目录结构\"><a href=\"#创建项目目录结构\" class=\"headerlink\" title=\"创建项目目录结构\"></a>创建项目目录结构</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div></pre></td><td class=\"code\"><pre><div class=\"line\">-------------------gulp-pro</div><div class=\"line\">|   |</div><div class=\"line\">|   |--------------dist (该文件夹为打包生成的)</div><div class=\"line\">|   |   |----------css</div><div class=\"line\">|   |   |   |------index-xxxx.css</div><div class=\"line\">|   |   |----------js</div><div class=\"line\">|   |   |   |------index-xxxx.js</div><div class=\"line\">|   |   |----------html</div><div class=\"line\">|   |   |   |------index.html</div><div class=\"line\">|   |</div><div class=\"line\">|   |--------------src</div><div class=\"line\">|   |   |----------scss</div><div class=\"line\">|   |   |   |------index.scss</div><div class=\"line\">|   |   |----------js</div><div class=\"line\">|   |   |   |------index.js</div><div class=\"line\">|   |   |----------html</div><div class=\"line\">|   |   |   |------index.html</div><div class=\"line\">|   |</div><div class=\"line\">|   |--------------gulpfile.js</div><div class=\"line\">|   |--------------package.json</div></pre></td></tr></table></figure>\n<h3 id=\"安装相关插件\"><a href=\"#安装相关插件\" class=\"headerlink\" title=\"安装相关插件\"></a>安装相关插件</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># 安装 Gulp 上 Babel 的插件</span></div><div class=\"line\">$ npm install --save-dev gulp-babel</div><div class=\"line\"><span class=\"comment\"># 安装 Babel 上将 ES6 转换成 ES5 的插件</span></div><div class=\"line\">$ npm install --save-dev babel-preset-es2015</div><div class=\"line\"><span class=\"comment\"># 安装 Gulp 上 uglify 压缩插件</span></div><div class=\"line\">$ npm install --save-dev gulp-uglify</div><div class=\"line\"><span class=\"comment\"># 安装 Gulp 上 sass 插件</span></div><div class=\"line\">$ npm install --save-dev gulp-sass</div><div class=\"line\"><span class=\"comment\"># 安装 Gulp 上 clean 插件</span></div><div class=\"line\">$ npm install --save-dev gulp-clean</div><div class=\"line\"><span class=\"comment\"># 安装 Gulp 上 rev 插件</span></div><div class=\"line\">$ npm install --save-dev gulp-rev</div><div class=\"line\"><span class=\"comment\"># 安装 Gulp 上 rev-collector 插件 </span></div><div class=\"line\">$ npm install --save-dev gulp-rev-collector</div></pre></td></tr></table></figure>\n<h3 id=\"gulpfile-js-内容如下\"><a href=\"#gulpfile-js-内容如下\" class=\"headerlink\" title=\"gulpfile.js 内容如下\"></a>gulpfile.js 内容如下</h3><figure class=\"highlight plain\"><figcaption><span>6</span></figcaption><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div></pre></td><td class=\"code\"><pre><div class=\"line\">var gulp = require(&quot;gulp&quot;);</div><div class=\"line\">var babel = require(&quot;gulp-babel&quot;);    // 用于ES6转化ES5</div><div class=\"line\">var uglify = require(&apos;gulp-uglify&apos;); // 用于压缩 JS</div><div class=\"line\">var sass = require(&apos;gulp-sass&apos;); //scss编译</div><div class=\"line\">var rev = require(&apos;gulp-rev&apos;); //rev hash码</div><div class=\"line\">var reCollector = require(&apos;gulp-rev-collector&apos;); //</div><div class=\"line\">var clean = require(&apos;gulp-clean&apos;);//清空文件夹里所有的文件</div><div class=\"line\">// ES6转化为ES5</div><div class=\"line\">// 在命令行使用 gulp toes5 启动此任务</div><div class=\"line\">gulp.task(&quot;toes5&quot;, () =&gt; &#123;</div><div class=\"line\">    return gulp.src(&quot;src/js/*.js&quot;)// ES6 源码存放的路径</div><div class=\"line\">        .pipe(babel())</div><div class=\"line\">        .pipe(gulp.dest(&quot;dist/js&quot;)); //转换成 ES5 存放的路径</div><div class=\"line\">&#125;);</div><div class=\"line\">//scss编译</div><div class=\"line\">gulp.task(&apos;css&apos;, () =&gt; &#123;</div><div class=\"line\">    gulp.src(&apos;src/scss/*.scss&apos;)</div><div class=\"line\">        .pipe(sass(&#123;</div><div class=\"line\">            outputStyle: &apos;compressed&apos;               //编译并输出压缩过的文件</div><div class=\"line\">        &#125;))</div><div class=\"line\">        .pipe(rev())                                //给css添加哈希值</div><div class=\"line\">        .pipe(gulp.dest(&apos;dist/css&apos;))</div><div class=\"line\">        .pipe(rev.manifest())                       //给添加哈希值的文件添加到清单中</div><div class=\"line\">        .pipe(gulp.dest(&apos;rev/css&apos;));</div><div class=\"line\">&#125;);</div><div class=\"line\">//压缩js</div><div class=\"line\">gulp.task(&apos;js&apos;, () =&gt; &#123;</div><div class=\"line\">    gulp.src(&apos;src/js/*.js&apos;)</div><div class=\"line\">        .pipe(babel()) //转换成 ES5 </div><div class=\"line\">        .pipe(uglify()) //压缩js</div><div class=\"line\">        .pipe(rev()) //给js添加哈希值</div><div class=\"line\">        .pipe(gulp.dest(&apos;dist/js&apos;))</div><div class=\"line\">        .pipe(rev.manifest()) //给添加哈希值的文件添加到清单中</div><div class=\"line\">        .pipe(gulp.dest(&apos;rev/js&apos;));</div><div class=\"line\">&#125;);</div><div class=\"line\">//将处理过的css，js引入html</div><div class=\"line\">gulp.task(&apos;reCollector&apos;, () =&gt; &#123;</div><div class=\"line\">    gulp.src([&apos;rev/**/*.json&apos;, &apos;src/html/*.html&apos;, &apos;src/html/**/*.html&apos;])</div><div class=\"line\">        .pipe(reCollector(&#123;</div><div class=\"line\">            replaceReved: true,  //模板中已经被替换的文件是否还能再被替换,默认是false</div><div class=\"line\">            dirReplacements: &#123;   //标识目录替换的集合, 因为gulp-rev创建的manifest文件不包含任何目录信息,</div><div class=\"line\">                &apos;css/&apos;: &apos;css/&apos;,</div><div class=\"line\">                &apos;js/&apos;: &apos;js/&apos;</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;))</div><div class=\"line\">        .pipe(gulp.dest(&apos;dist/html&apos;))</div><div class=\"line\">&#125;);</div><div class=\"line\">//每次打包时先清空原有的文件夹</div><div class=\"line\">gulp.task(&apos;clean&apos;, () =&gt; &#123;</div><div class=\"line\">    gulp.src([&apos;dist&apos;, &apos;rev&apos;], &#123;read: false&#125;) //这里设置的dist表示删除dist文件夹及其下所有文件</div><div class=\"line\">        .pipe(clean());</div><div class=\"line\">&#125;);</div></pre></td></tr></table></figure>\n<h3 id=\"task执行命令\"><a href=\"#task执行命令\" class=\"headerlink\" title=\"task执行命令\"></a>task执行命令</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># gulp 任务名称</span></div><div class=\"line\">$ gulp toes5 //转为es5</div><div class=\"line\">$ gulp css //scss编译</div><div class=\"line\">$ gulp js //js压缩</div><div class=\"line\">$ gulp reCollector //替换html中的js/css文件</div><div class=\"line\">$ gulp clean //清空文件</div></pre></td></tr></table></figure>\n<h3 id=\"github项目地址-https-github-com-monmiao-gulp-pro\"><a href=\"#github项目地址-https-github-com-monmiao-gulp-pro\" class=\"headerlink\" title=\"github项目地址 https://github.com/monmiao/gulp-pro\"></a>github项目地址 <a href=\"https://github.com/monmiao/gulp-pro\" target=\"_blank\" rel=\"external\">https://github.com/monmiao/gulp-pro</a></h3><h3 id=\"说明\"><a href=\"#说明\" class=\"headerlink\" title=\"说明\"></a>说明</h3><ul>\n<li>该文档是自己学习时的记录,如果错误欢迎留言指正,如有转载,请注明出处,谢谢.</li>\n</ul>\n","categories":["技术"],"tags":["笔记"]},{"title":"Hello World","url":"https://monmiao.github.io/2017/03/10/hello-world/","content":"<p>Welcome to <a href=\"https://hexo.io/\" target=\"_blank\" rel=\"external\">Hexo</a>! This is your very first post. Check <a href=\"https://hexo.io/docs/\" target=\"_blank\" rel=\"external\">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href=\"https://hexo.io/docs/troubleshooting.html\" target=\"_blank\" rel=\"external\">troubleshooting</a> or you can ask me on <a href=\"https://github.com/hexojs/hexo/issues\" target=\"_blank\" rel=\"external\">GitHub</a>.</p>\n<h2 id=\"Quick-Start\"><a href=\"#Quick-Start\" class=\"headerlink\" title=\"Quick Start\"></a>Quick Start</h2><h3 id=\"Create-a-new-post\"><a href=\"#Create-a-new-post\" class=\"headerlink\" title=\"Create a new post\"></a>Create a new post</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ hexo new <span class=\"string\">\"My New Post\"</span></div></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/writing.html\" target=\"_blank\" rel=\"external\">Writing</a></p>\n<h3 id=\"Run-server\"><a href=\"#Run-server\" class=\"headerlink\" title=\"Run server\"></a>Run server</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ hexo server</div></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/server.html\" target=\"_blank\" rel=\"external\">Server</a></p>\n<h3 id=\"Generate-static-files\"><a href=\"#Generate-static-files\" class=\"headerlink\" title=\"Generate static files\"></a>Generate static files</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ hexo generate</div></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/generating.html\" target=\"_blank\" rel=\"external\">Generating</a></p>\n<h3 id=\"Deploy-to-remote-sites\"><a href=\"#Deploy-to-remote-sites\" class=\"headerlink\" title=\"Deploy to remote sites\"></a>Deploy to remote sites</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ hexo deploy</div></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/deployment.html\" target=\"_blank\" rel=\"external\">Deployment</a></p>\n","categories":["测试"],"tags":[]},{"title":"hexo使用指南(简单)","url":"https://monmiao.github.io/2017/03/09/hexo-user-guide/","content":"<h3 id=\"1-安装node\"><a href=\"#1-安装node\" class=\"headerlink\" title=\"1.安装node\"></a>1.安装node</h3><h3 id=\"2-注册github\"><a href=\"#2-注册github\" class=\"headerlink\" title=\"2.注册github\"></a>2.注册github</h3><ul>\n<li>以上两步,我已经安装了,不懂得找度娘,或者留言.</li>\n</ul>\n<h3 id=\"3-安装hexo\"><a href=\"#3-安装hexo\" class=\"headerlink\" title=\"3.安装hexo\"></a>3.安装hexo</h3><ul>\n<li>首先创建一个文件夹,如blog,用户存放hexo的配置文件,然后进入blog里安装Hexo。命令: </li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ cd blog</div><div class=\"line\">$ sudo npm install -g hexo</div><div class=\"line\">$ hexo init</div></pre></td></tr></table></figure>\n<ul>\n<li>执行完以上的命令后,就基本完成了初始化的工作,以后博客的所以操作都是blog的目录下面hexo相关命令(常用):</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ hexo init 初始化</div><div class=\"line\">$ hexo generate (hexo g 也可以) 生成静态页面</div><div class=\"line\">$ hexo server (hexo s 也可以) 启动本地服务 浏览器 http://localhost:4000 就可以预览</div><div class=\"line\">$ hexo deploy 部署</div><div class=\"line\">$ hexo new&quot;postName&quot; #新建文章</div><div class=\"line\">$ hexo new page&quot;pageName&quot; #新建页面</div><div class=\"line\">$ hexo generate #生成静态页面至public目录</div><div class=\"line\">$ hexo server #开启预览访问端口（默认端口4000，&apos;ctrl + c&apos;关闭server）</div><div class=\"line\">$ hexo deploy #将.deploy目录部署到GitHub</div><div class=\"line\">$ hexo help # 查看帮助</div><div class=\"line\">$ hexo version #查看Hexo的版本</div></pre></td></tr></table></figure>\n<h3 id=\"4-部署-此处省去github配置\"><a href=\"#4-部署-此处省去github配置\" class=\"headerlink\" title=\"4.部署 (此处省去github配置)\"></a>4.部署 (此处省去github配置)</h3><ul>\n<li>部署步骤,可按以下三步来进行:</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ hexo clean</div><div class=\"line\">$ hexo generate</div><div class=\"line\">$ hexo deploy</div></pre></td></tr></table></figure>","categories":["技术"],"tags":["笔记"]},{"title":"about","url":"https://monmiao.github.io/about/index.html","content":"","categories":[],"tags":[]},{"title":"category","url":"https://monmiao.github.io/category/index.html","content":"","categories":[],"tags":[]},{"title":"link","url":"https://monmiao.github.io/link/index.html","content":"","categories":[],"tags":[]},{"title":"project","url":"https://monmiao.github.io/project/index.html","content":"","categories":[],"tags":[]},{"title":"search","url":"https://monmiao.github.io/search/index.html","content":"","categories":[],"tags":[]},{"title":"tag","url":"https://monmiao.github.io/tag/index.html","content":"","categories":[],"tags":[]}]